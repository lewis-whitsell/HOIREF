#Unlisted on_actions by haveabeard
#http://forum.paradoxplaza.com/forum/index.php?threads/list-of-currently-hardcoded-features-mechanics-etc-in-hoi4.957265/page-25#post-22275603
#military_access
#offer_military_access
#improve_relation
#guarantee
#non_aggression_pact
#call_allies
#join_allies
#declare_war
#create_faction
#join_faction
#offer_join_faction
#peace_proposal
#add_wargoal
#lend_lease
#incoming_lend_lease
#send_volunteers
#send_expeditionary_force
#return_expeditionary_forces
#request_expeditionary_forces
#generate_wargoal
#boost_party_popularity
#stage_coup
#leave_faction
#dismantle_faction
#ask_for_state_control
#give_state_control
#reduce_autonomy
#increase_autonomy

on_actions = {
	# country 
	on_new_term_election = {
		
		random_events = {
		100 = brazil.1
		}
		
		random_events = {
			100 = MD4_election_campaign.0
			# 100 = election.3
			# 100 = election.4
			# 100 = election.5
			# 100 = election.6
			# 100 = election.11
			# 100 = election.12
			# 100 = election.13
			# 100 = election.14
			# 100 = election.15
		}
	}

	# Ace pilots
	# country, FROM = ace
	on_ace_promoted = {
		
	}

	# country, FROM = ace, PREV = enemy ace 
	# This event fires twice, once for each ace.
	on_aces_killed_each_other = {
		
	}
	
	# country, FROM = our ace, 
	# PREV = enemy ace, has killed FROM
	on_ace_killed_by_ace = {
		
	}

	# country, FROM = our ace, 
	# PREV = enemy ace, killed by FROM
	on_ace_killed_other_ace = {
		
	}

	# country, FROM = ace
	on_ace_killed = {
		
	}

	# During justifying wargoals
	# triggered daily, so make sure there is a sink somewhere not firing events
	# country, FROM = target nation
	on_justifying_wargoal_pulse = {
		random_events = {
			1000 = NATO.1
		}
	}

	on_wargoal_expire = {
		effect = {
		
		}
	}

	#FROM is state #ROOT is broken as hell
	on_nuke_drop = {
		effect = {
		}
	}

	on_border_war_lost = {
		effect = {
		
		}
	}
	
	on_leave_faction = {
		effect = {
		
		}
	}

	#FROM is the one that joins the faction
	on_create_faction = {
		effect = {
		
		}
	}

	#FROM is country getting invited.
	on_offer_join_faction = {
		effect = {
		
		}
	}

	#FROM is faction leader on join faction requests.
	on_join_faction = {
		effect = {
		
		}
	}
	
	# ROOT is capitulated country, FROM is winner
	on_capitulation = {
		effect = {
			news_event = { id = country_capitulated.0 days = 1 }
		}
	}

	#FROM is war target
	on_declare_war = {
		effect = {
			#Used in MD4_Anti_bully decissions
			hidden_effect = { add_timed_idea = { idea = three_months_of_war days = 6 } }
			from = { hidden_effect = {  add_timed_idea = { idea = three_months_of_war days = 6 } } }
			
			#NATO
			if = {
				limit = {
					FROM = { has_idea = NATO_member }
				}
				custom_effect_tooltip = TT_CALL_NATO
				if = {
					limit = {
						NOT = { has_global_flag = NATO_called_to_arms }
					}
					FROM = { country_event = NATO.2 }
				}
				set_country_flag = Attacked_NATO
			}
			
			#Starts Anti-Bully War
			if = {
				limit = {
					from = { is_major = no}
					from = { ic_ratio = { tag = ROOT ratio < 0.4 } }
					not = { has_government = fascism}
					threat < 0.60
					from = { any_owned_state = { not = { is_core_of = ROOT } } }
				}
				hidden_effect = {
					save_event_target_as = AB_ATT
					from = {
						save_event_target_as = AB_DEFF
					}
					country_event = { id = anti_bully.1 }
				}
				
			}
			
			###Activates US Brigade In Poland If US has done USA_Reinforce_NATO_EAST focus
			if = {
				limit = {
					FROM = {
						is_in_faction_with = USA
						or = {
							tag = EST
							tag = LAT
							tag = LIT
							tag = POL
							tag = SLO
							tag = HUN
							tag = ROM
							
						}
					}
					POL = {
						is_in_faction_with = USA
					}
					USA = {
						has_country_flag = Reinforce_NATO_EAST
					}
				}
				hidden_effect = {
					country_event = { id = USA_FOCUS.2 }
				}
				
				country_event = { id = USA_FOCUS.2 days = 1 }
				add_threat = 5
				
			}
			
			###Activates US Brigade In Turkey If US has done USA_REINFORCE_Bosphorus focus
			if = {
				limit = {
					FROM = {
						is_in_faction_with = USA
						or = {
							tag = BUL
							tag = GRE
							tag = ALB
							tag = TUR
							
						}
					}
					TUR = {
						is_in_faction_with = USA
					}
					USA = {
						has_country_flag = REINFORCE_Bosphorus
					}
				}
				hidden_effect = {
					USA = {
						country_event = { id = USA_FOCUS.4 }
					}
					USA = {
						country_event = { id = USA_FOCUS.4 days = 1 }
					}
				}
				
			}
			
			#Rio Pact
			if = {
				limit = {
					from = {
						has_idea = rio_pact_member
					}
					ROOT = {
						not = {
							or = {
								tag = ISI
								tag = TAL
								tag = TTP
								tag = NUS
								tag = AQY
								has_country_flag = terrorist_group
							}
						}
					}
				}
				FROM = { country_event = { id = USA.6 } }
				ROOT = { country_event = { id = USA.8 days = 20 } }
			}
			
		}
	}
	
	#Ask for Mil access - From is target country
	on_military_access = {
		effect = {
			#country_event = { id = init.1 }
			#from = { add_ideas = USA_USAID }
			if = {
				limit = { has_government = fascism } #Salafist
			}
			if = {
				limit = { has_government = democratic } #Western
			}
			if = {
				limit = { has_government = communism  } #Emerging
			}
			if = {
				limit = { has_government = neutrality  } #neutrality 
			}
			if = {
				limit = { has_government = Nationalist  } #Nationalist 
			}
			
		}
	}
	
	#offer for Mil access to your country - From is target country
	on_offer_military_access = {
		effect = {
			#from = { country_event = { id = init.1 } }
			#add_ideas = USA_USAID
		}
	}
	#try on_revoke_guarantee
	
	# When a new faction is formed
	on_faction_formed = {
		effect = {
		}
	}

	on_government_change = {
		effect = {
		}
	}

	on_coup_succeeded = {
		effect = {
			ROOT = {
				country_event = {id = init.2}
			}
		}
	}

	#ROOT is winner #FROM gets annexed
	on_civil_war_end = {
		effect = {
		}
	}

	# on_guarantee = {
		# effect = {
			# news_event = { id = war.0 }
		# }
	# }
	# on_non_aggression_pact = {
		# effect = {
			# news_event = { id = war.0 }
		# }
	# }
	# on_improve_relation = {
		# effect = {
			# news_event = { id = war.0 }
		# }
	# }
	  
	on_startup = {
		effect = {
			every_country = {
				country_event = { id = init.0 }
				if = {
					limit = { is_ai = no }
					news_event = { id = init.3 } #MD4 v0.01 warning
				}
			}
			random_country = {
				country_event = { id = init_relations.0 }
			}
			USA = {
				country_event = { id = USA.1 days = 1 }
				country_event = { id = USA.2 days = 19 }
			}
			
			ISI = {
				if = { 
				limit = { is_ai = yes }
				set_technology = {
					ISIS_JIHAD = 1
					}
				}
				if = { 
				limit = { is_ai = no }
				set_technology = {
					ISIS_JIHAD_HUMAN = 1
					}
				}
			}
			random_country = {
				limit = { is_ai = yes has_war = no }
				set_country_flag = MD4_init_stability
			}
			random_country = {
				limit = { is_ai = yes has_war = no }
				set_country_flag = MD4_init_debt
			}
			
		}
	}
	on_government_change = {
		effect = {
			every_neighbor_country = { 
				clear_neighbor_count_ideas = yes
				set_country_flag = { flag = neighbor_count value = 0 }
				
					every_neighbor_country = { 
						limit = { 
							has_government = fascism 
							is_major = no
						}
						PREV = { modify_country_flag = { flag = neighbor_count value = 1 }
						}
					}

				salafist_count = yes
				clr_country_flag = neighbor_count
				set_country_flag = { flag = neighbor_count value = 0 }
				
					every_neighbor_country = { 
						limit = { 
							has_government = fascism 
							is_major = yes
						}
						PREV = { modify_country_flag = { flag = neighbor_count value = 1 } }
					}
				
				salafist_major_count = yes
				clr_country_flag = neighbor_count
				set_country_flag = { flag = neighbor_count value = 0 }
				
					every_neighbor_country = { 
						limit = { 
							has_government = democratic 
							is_major = no
						}
						PREV = { modify_country_flag = { flag = neighbor_count value = 1 } }
					}

				western_count = yes
				clr_country_flag = neighbor_count
				set_country_flag = { flag = neighbor_count value = 0 }
				
					every_neighbor_country = { 
						limit = { 
							has_government = democratic 
							is_major = yes
						}
						PREV = { modify_country_flag = { flag = neighbor_count value = 1 } }
					}
				
				western_major_count = yes
				clr_country_flag = neighbor_count
				set_country_flag = { flag = neighbor_count value = 0 }
				
				every_neighbor_country = { 
						limit = { 
							has_government = communism 
							is_major = no
						}
						PREV = { modify_country_flag = { flag = neighbor_count value = 1 } }
					}

				emerging_count = yes
				clr_country_flag = neighbor_count
				set_country_flag = { flag = neighbor_count value = 0 }
				
					every_neighbor_country = { 
						limit = { 
							has_government = communism 
							is_major = yes
						}
						PREV = { modify_country_flag = { flag = neighbor_count value = 1 } }
					}
				
				emerging_major_count = yes
				clr_country_flag = neighbor_count
				set_country_flag = { flag = neighbor_count value = 0 }
				
				every_neighbor_country = { 
						limit = { 
							has_government = neutrality 
							is_major = no
						}
						PREV = { modify_country_flag = { flag = neighbor_count value = 1 } }
					}

				non_alligned_count = yes
				clr_country_flag = neighbor_count
				set_country_flag = { flag = neighbor_count value = 0 }
				
					every_neighbor_country = { 
						limit = { 
							has_government = neutrality 
							is_major = yes
						}
						PREV = { modify_country_flag = { flag = neighbor_count value = 1 } }
					}
				
				non_alligned_major_count = yes
				clr_country_flag = neighbor_count
				set_country_flag = { flag = neighbor_count value = 0 }
				
				every_neighbor_country = { 
						limit = { 
							has_government = Nationalist 
							is_major = no
						}
						PREV = { modify_country_flag = { flag = neighbor_count value = 1 } }
					}

				nationalist_count = yes
				clr_country_flag = neighbor_count
				set_country_flag = { flag = neighbor_count value = 0 }
				
					every_neighbor_country = { 
						limit = { 
							has_government = Nationalist 
							is_major = yes
						}
						PREV = { modify_country_flag = { flag = neighbor_count value = 1 } }
					}
				
				nationalist_major_count = yes
				clr_country_flag = neighbor_count
				
			}
			clear_own_ideology_drift = yes
			### Boost to ruling parties ###
			if = {
				limit = {
					has_government = fascism
					is_major = no
				}
				add_ideas = ruling_party_salafist
			}
			if = {
				limit = {
					has_government = fascism
					is_major = yes
				}
				add_ideas = major_ruling_party_salafist
			}
			if = {
				limit = {
					has_government = democratic
					is_major = no
				}
				add_ideas = ruling_party_western
			}
			if = {
				limit = {
					has_government = democratic
					is_major = yes
				}
				add_ideas = major_ruling_party_western
			}
			if = {
				limit = {
					has_government = communism
					is_major = no
				}
				add_ideas = ruling_party_emerging
			}
			if = {
				limit = {
					has_government = communism
					is_major = yes
				}
				add_ideas = major_ruling_party_emerging
			}
			if = {
				limit = {
					has_government = neutrality
					is_major = no
				}
				add_ideas = ruling_party_non_alligned
			}
			if = {
				limit = {
					has_government = neutrality
					is_major = yes
				}
				add_ideas = major_ruling_party_non_alligned
			}
			if = {
				limit = {
					has_government = Nationalist
					is_major = no
				}
				add_ideas = ruling_party_nationalist
			}
			if = {
				limit = {
					has_government = Nationalist
					is_major = yes
				}
				add_ideas = major_ruling_party_nationalist
			}
			clear_previous_economic_drift = yes
			if = {
				limit = {
					has_idea = economic_boom
				}
				update_drift_economic_boom = yes
			}
			if = {
				limit = {
					has_idea = fast_growth
				}
				update_drift_fast_growth = yes
			}
			if = {
				limit = {
					has_idea = stagnation
				}
				update_drift_stagnation = yes
			}
			if = {
				limit = {
					has_idea = recession
				}
				update_drift_recession = yes
			}
			if = {
				limit = {
					has_idea = depression
				}
				update_drift_depression = yes
			}
		}
	}
}
