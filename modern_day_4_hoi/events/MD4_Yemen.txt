add_namespace = Yemen

### Yemeni civil war cleanup events ###

#Give the winner YEM cosmetic tag
country_event = {
	id = Yemen.0
	
	hidden = yes
	
	trigger = {
		OR = {
			AND = {
				tag = HOU
				NOT = {
					country_exists = YEM
					country_exists = AQY
				}
			}
			AND = {
				tag = YEM
				NOT = {
					country_exists = HOU
					country_exists = AQY
				}
			}
			AND = {
				tag = AQY
				NOT = {
					country_exists = HOU 
					country_exists = YEM
				}
			}
		}
		NOT = { has_global_flag = Yemen_Civil_War_Over }
	}
	
	immediate = {
		#Civil war is over
		set_global_flag = Yemen_Civil_War_Over
		#Clear core status
		194 = {
			remove_core_of = YEM
			remove_core_of = AQY
			remove_core_of = HOU
		}
		195 = {
			remove_core_of = YEM
			remove_core_of = AQY
			remove_core_of = HOU
		}
		196 = {
			remove_core_of = YEM
			remove_core_of = AQY
			remove_core_of = HOU
		}
		197 = {
			remove_core_of = YEM
			remove_core_of = AQY
			remove_core_of = HOU
		}
		198 = {
			remove_core_of = YEM
			remove_core_of = AQY
			remove_core_of = HOU
		}
		199 = {
			remove_core_of = YEM
			remove_core_of = AQY
			remove_core_of = HOU
		}
		200 = {
			remove_core_of = YEM
			remove_core_of = AQY
			remove_core_of = HOU
		}
		#Make the winner Yemen
		if = {
			limit = {
				OR = {
					tag = HOU
					#tag = AQY
				}
			}
			set_cosmetic_tag = YEM
		}
		add_state_core = 194
		add_state_core = 195
		add_state_core = 196
		add_state_core = 197
		add_state_core = 198
		add_state_core = 199
		add_state_core = 200
		set_capital = 195
		
	}
	
	mean_time_to_happen = {
		days = 2
	}
	
	option = {
		name = Yemen.0.a
	}
}

#Al-Qaeda in Yemen is beaten. Force a peace deal as not to drag the war on forever
country_event = {
	id = Yemen.1
	
	hidden = yes
	
	trigger = {
		country_exists = AQY
		AQY = { 
			has_capitulated = yes
			is_in_faction = yes 
		}
		NOT = { has_global_flag = Yemen_Civil_War_Over } 	#No special rules if Al-Qaeda has already won Yemeni civil war
	}
	
	immediate = {
		remove_from_faction = AQY
	}
	
	mean_time_to_happen = {
		days = 2
	}
	
	option = {
		name = Yemen.1.a
	}
}

#Recreate Yemen in case it has been annexed
country_event = {
	id = Yemen.2
	
	hidden = yes
	
	trigger = {
		NOT = {
			country_exists = YEM
			country_exists = AQY
			country_exists = HOU
		}
		NOT = { 195 = { is_core_of = YEM } }
	}
	
	immediate = {
		#Clear core status
		194 = {
			remove_core_of = YEM
			remove_core_of = AQY
			remove_core_of = HOU
		}
		195 = {
			remove_core_of = YEM
			remove_core_of = AQY
			remove_core_of = HOU
		}
		196 = {
			remove_core_of = YEM
			remove_core_of = AQY
			remove_core_of = HOU
		}
		197 = {
			remove_core_of = YEM
			remove_core_of = AQY
			remove_core_of = HOU
		}
		198 = {
			remove_core_of = YEM
			remove_core_of = AQY
			remove_core_of = HOU
		}
		199 = {
			remove_core_of = YEM
			remove_core_of = AQY
			remove_core_of = HOU
		}
		200 = {
			remove_core_of = YEM
			remove_core_of = AQY
			remove_core_of = HOU
		}
		YEM = {
			add_state_core = 194
			add_state_core = 195
			add_state_core = 196
			add_state_core = 197
			add_state_core = 198
			add_state_core = 199
			add_state_core = 200
			set_capital = 195
		}
	}
	
	mean_time_to_happen = {
		days = 2
	}
	
	option = {
		name = Yemen.2.a
	}
}

### Yemeni Post Civil War Events ###

# General Civil War Ending Event
news_event = {
    id = Yemen.4
    title = Yemen.4.t
    picture = GFX_Yem_CivilWar_End
	desc = {
	    text = Yemen.4.d
	    trigger = {
	        country_exists = YEM
		    NOT = { country_exists = AQY }
			NOT = { country_exists = HOU }
	    }                                
	}                                    
	                                     
	desc = {                             
	    text = Yemen.4.d2                
	    trigger = {                      
	        country_exists = HOU         
		    NOT = { country_exists = AQY }
			NOT = { country_exists = YEM }
	    }                                
	}                                    
	                                     
	desc = {                             
	    text = Yemen.4.d3                
	    trigger = {                      
	        country_exists = AQY         
		    NOT = { country_exists = YEM }
			NOT = { country_exists = HOU }
	    }
	}
	
	major = yes
	is_triggered_only = yes
    
    #Option if Houthis wins
    option = {
        name = Yemen.4.a
        trigger = { tag = HOU }
    }
    
    #Option if Yemen wins
    option = {
        name = Yemen.4.b
        trigger = { tag = YEM }
    }
	
    #Option if Ansar al-Sharia wins
    option = {
        name = Yemen.4.c
        trigger = { tag = AQY }
    }
	
	#Option for the rest of the world
    option = {
        name = Yemen.4.e
		trigger = {
			NOT = {
				TAG = YEM
				TAG = HOU
				TAG = AQY
				tag = SAU
		        tag = UAE
		        tag = BHR
		        tag = KUW
		        tag = EGY
		        tag = JOR
		        tag = MOR
		        tag = SEN
		        tag = SUD
				
			}
		}
    }
	
	#Option for Saudi Coalition
    option = {
        name = Yemen.4.f
		trigger = {
		or = {
		    tag = SAU
		    tag = UAE
		    tag = BHR
		    tag = KUW
		    tag = EGY
		    tag = JOR
		    tag = MOR
		    tag = SEN
		    tag = SUD
	        }
		}
		remove_ideas = restoring_hope
    }
}

# Trigger News Event
country_event = {
    id = Yemen.5
	
	hidden = yes
	fire_only_once = yes
	
	trigger = {
        # or means Any of the following must be true    
        or = {
            #If Houthis wins
            and = {
			HOU = { has_global_flag = Yemen_Civil_War_Over }
                country_exists = HOU
                NOT = {
                    country_exists = YEM
                    country_exists = AQY
                }
            }
           #If Yemen wins
            and = {
			YEM = { has_global_flag = Yemen_Civil_War_Over }
                country_exists = YEM
                NOT = {
                    country_exists = HOU
                    country_exists = AQY
                }
            }
           #If AQY Wins
            and = {
			AQY = { has_global_flag = Yemen_Civil_War_Over }
                country_exists = AQY
                NOT = {
                    country_exists = HOU
                    country_exists = YEM
                }
            }    
        }
    }
	
	immediate = {
		news_event = { id = Yemen.4 }
	}
	
	option = {
		name = Yemen.5.a
	}
}

#Yemen Fires Missile decision
country_event = {
    id = Yemen.6
    title = Yemen.6.t
    desc = Yemen.6.d
	
	fire_only_once = yes
	
	trigger = {
       has_war_with = YEM
	   tag = HOU
    }
	
	mean_time_to_happen = {
		days = 300
	}
	
	option = {
		name = Yemen.6.a
		add_political_power = 100
		country_event = { id = Yemen.7 }
	}
	option = {
		name = Yemen.6.b
	}
}

#Yemen Fires Missile news event 
news_event = {
	id = Yemen.7
	title = Yemen.7.t
	desc = Yemen.7.d
	picture = GFX_SAU_YEM_Missile

	#fire_only_once = yes
	major = yes
	is_triggered_only = yes

	option = {
		name = Yemen.7.a
	}
}
			