###########################
# Autonomy Events
###########################
# By Rylock
###########################

add_namespace = kr.political

# There are five main puppet levels:
#   1. Integrated Puppet (kr_integrated_puppet) - the lowest, and countries normally can't raise above this if set here
#   2. Occupied Puppet (kr_occupied_puppet) - the default state, countries will be able to raise to the next level once they get some military, based on their size
#   3. Puppet (kr_default_puppet) - the equivalent to the old colony level, only majors can generally raise higher than this on their own
#	4. Autonomous Puppet (kr_autonomous_puppet) - the equivalent to the old dominion level, only majors can raise higher than this on their own
#	5. Nominal Puppet (kr_nominal_puppet) - a puppet in name only, barely restricted, majors can eventually move to freedom from this level
#
# NOTE: Currently there is no system in place for moving autonomy back downwards
#

# Occupied Puppet moves to Puppet level once they've established a military
country_event = {
	id = kr.political.100
	title = kr.political.100.t
	desc = kr.political.100.d
	picture = diplomacy4
	
	trigger = {
		is_subject = yes
		has_autonomy_state = kr_occupied_puppet
		has_political_power > 0
		has_war = no
		OR = {
			AND = {
				num_of_controlled_states < 3
				num_divisions > 1
			}
			AND = {
				num_of_controlled_states < 6
				num_divisions > 3
			}
			AND = {
				num_of_controlled_states < 11
				num_divisions > 6
			}
			AND = {
				num_of_controlled_states < 16
				num_divisions > 10
			}
			AND = {
				num_of_controlled_states > 15
				num_divisions > 15
			}
		}	
		NOT = { has_country_flag = KR_can_raise_autonomy_level }
	}
	
	mean_time_to_happen = {
		days = 90
	}
	
	immediate = {
		set_country_flag = KR_can_raise_autonomy_level
		overlord = { save_event_target_as = overlord_name }
	}
	
	option = {
		name = kr.political.100.a
		custom_effect_tooltip = may_raise_autonomy
	}
}

# Puppet who is a major moves to Autonomous Puppet
country_event = {
	id = kr.political.101
	title = kr.political.101.t
	desc = kr.political.101.d
	picture = diplomacy4
	
	trigger = {
		is_subject = yes
		is_major = yes
		has_autonomy_state = kr_default_puppet
		has_army_manpower = { size > 100000 }
		NOT = {
			has_country_flag = KR_can_raise_autonomy_level
			any_owned_state = { NOT = { is_controlled_by = ROOT } }
		}
	}
	
	mean_time_to_happen = {
		months = 36
		modifier = {
			factor = 1.5
			has_war = yes
		}
		modifier = {
			factor = 0.5
			overlord = { has_government = syndicalist }
		}
		modifier = {
			factor = 0.8
			has_army_manpower = { size > 125000 }
		}
		modifier = {
			factor = 0.8
			has_army_manpower = { size > 125000 }
		}
		modifier = {
			factor = 0.8
			has_army_manpower = { size > 150000 }
		}
		modifier = {
			factor = 0.8
			has_army_manpower = { size > 175000 }
		}
		modifier = {
			factor = 0.8
			has_army_manpower = { size > 200000 }
		}
	}
	
	immediate = {
		set_country_flag = KR_can_raise_autonomy_level
		overlord = { save_event_target_as = overlord_name }
	}
	
	option = {
		name = kr.political.101.a
		custom_effect_tooltip = may_raise_autonomy
	}
}

# Puppet who is a major (or much stronger than overlord) moves to Autonomous Puppet
country_event = {
	id = kr.political.102
	title = kr.political.101.t
	desc = kr.political.101.d
	picture = diplomacy4
	
	trigger = {
		is_subject = yes
		OR = {
			is_major = yes
			overlord = {
				strength_ratio = { tag = ROOT ratio < 0.5 }
			}
		}
		has_autonomy_state = kr_default_puppet
		has_army_manpower = { size > 100000 }
		NOT = {
			has_country_flag = KR_can_raise_autonomy_level
			any_owned_state = { NOT = { is_controlled_by = ROOT } }
		}
	}
	
	mean_time_to_happen = {
		months = 36
		modifier = {
			factor = 1.5
			has_war = yes
		}
		modifier = {
			factor = 0.5
			overlord = { has_government = syndicalist }
		}
		modifier = {
			factor = 0.5
			overlord = {
				strength_ratio = { tag = ROOT ratio < 0.5 }
			}
		}
		modifier = {
			factor = 0.8
			has_army_manpower = { size > 125000 }
		}
		modifier = {
			factor = 0.8
			has_army_manpower = { size > 125000 }
		}
		modifier = {
			factor = 0.8
			has_army_manpower = { size > 150000 }
		}
		modifier = {
			factor = 0.8
			has_army_manpower = { size > 175000 }
		}
		modifier = {
			factor = 0.8
			has_army_manpower = { size > 200000 }
		}
	}
	
	immediate = {
		set_country_flag = KR_can_raise_autonomy_level
		overlord = { save_event_target_as = overlord_name }
	}
	
	option = {
		name = kr.political.101.a
		custom_effect_tooltip = may_raise_autonomy
	}
}

# Autonomous Puppet who is a major moves to Nominal Puppet
country_event = {
	id = kr.political.103
	title = kr.political.101.t
	desc = kr.political.101.d
	picture = diplomacy4
	
	trigger = {
		is_subject = yes
		is_major = yes
		has_autonomy_state = kr_autonomous_puppet
		has_army_manpower = { size > 100000 }
		NOT = {
			has_country_flag = KR_can_raise_autonomy_level
			any_owned_state = { NOT = { is_controlled_by = ROOT } }
		}
	}
	
	mean_time_to_happen = {
		months = 36
		modifier = {
			factor = 1.5
			has_war = yes
		}
		modifier = {
			factor = 0.5
			overlord = { has_government = syndicalist }
		}
		modifier = {
			factor = 0.5
			overlord = {
				strength_ratio = { tag = ROOT ratio < 0.5 }
			}
		}
		modifier = {
			factor = 0.8
			has_army_manpower = { size > 125000 }
		}
		modifier = {
			factor = 0.8
			has_army_manpower = { size > 125000 }
		}
		modifier = {
			factor = 0.8
			has_army_manpower = { size > 150000 }
		}
		modifier = {
			factor = 0.8
			has_army_manpower = { size > 175000 }
		}
		modifier = {
			factor = 0.8
			has_army_manpower = { size > 200000 }
		}
	}
	
	immediate = {
		set_country_flag = KR_can_raise_autonomy_level
		overlord = { save_event_target_as = overlord_name }
	}
	
	option = {
		name = kr.political.101.a
		custom_effect_tooltip = may_raise_autonomy
	}
}

# Nominal Puppet who is a major can become free
country_event = {
	id = kr.political.104
	title = kr.political.101.t
	desc = kr.political.101.d
	picture = diplomacy4
	
	trigger = {
		is_subject = yes
		is_major = yes
		has_autonomy_state = kr_nominal_puppet
		has_army_manpower = { size > 100000 }
		NOT = {
			has_country_flag = KR_can_become_free
			any_owned_state = { NOT = { is_controlled_by = ROOT } }
		}
	}
	
	mean_time_to_happen = {
		months = 36
		modifier = {
			factor = 1.5
			has_war = yes
		}
		modifier = {
			factor = 0.5
			overlord = { has_government = syndicalist }
		}
		modifier = {
			factor = 0.5
			overlord = {
				strength_ratio = { tag = ROOT ratio < 0.5 }
			}
		}
		modifier = {
			factor = 0.8
			has_army_manpower = { size > 125000 }
		}
		modifier = {
			factor = 0.8
			has_army_manpower = { size > 125000 }
		}
		modifier = {
			factor = 0.8
			has_army_manpower = { size > 150000 }
		}
		modifier = {
			factor = 0.8
			has_army_manpower = { size > 175000 }
		}
		modifier = {
			factor = 0.8
			has_army_manpower = { size > 200000 }
		}
	}
	
	immediate = {
		set_country_flag = KR_can_become_free
		overlord = { save_event_target_as = overlord_name }
	}
	
	option = {
		name = kr.political.101.a
		custom_effect_tooltip = may_become_free
	}
}

